<html>
  <head>
    <title>Socket.IO chat</title>
    <link rel="stylesheet" href="/public/css/style.css">

  </head>

  <body>
    <ul id="messages"></ul>

    <form id="form" action="">
      <input id="input" autocomplete="off" /><button>Send</button>
    </form>

    <script src="/socket.io/socket.io.js"></script>

    <script>
      var socket = io();
      let nome = prompt("Qual o seu nome?")

      alert("Bom vindo ao Danki Chat " + nome)

      var messages = document.getElementById('messages');
      var form = document.getElementById('form');
      var input = document.getElementById('input');

      form.addEventListener('submit',(e)=>{
        e.preventDefault();
        if(input.value){
          socket.emit('chat message',{msg:input.value, nome:nome});
          input.value='';
          // alert('Menssagem enviada com sucesso!!');;
        }
      })

      socket.on('chat message',function(obj){
        if( obj.nome == nome ){
          var item = document.createElement('li');
          item.style.backgroundColor = 'gray';
          item.textContent = obj.nome + ': ' + obj.msg;
          messages.appendChild(item);
          window.scrollTo(0, document.body.scrollHeight)
        }else{
          var item = document.createElement('li');
          item.style.backgroundColor = 'black';
          item.style.color = 'white';
          item.textContent = obj.nome + ': ' + obj.msg;
          messages.appendChild(item);
          window.scrollTo(0, document.body.scrollHeight)
        }
      })

    </script>
  </body>
</html>
